<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<title>shovel blueで遊べる</title>
<style>
  body{font-family:sans-serif;padding:20px;}
  button{padding:8px 16px;margin:6px;font-size:16px;}
  .result{margin-top:1em;font-size:20px;white-space:pre-wrap;word-break:break-word;}
</style>
</head>
<body>
  <h1>ふぃいいいいいいいいいん</h1>
  <label>きゃんきょんカウント <input id="count" type="number" value="8" min="1" max="9999"></label>
  <button id="genBtn">生成してきんきん</button>
  <div id="result" class="result">（ここにふうふんんん）</div>

<script>
  const TOKENS = [
    "てーーーーーーーーれーーーーーーー",
    "ふぃいいいいいいいいいん",
    "んんんふうふんんん",
    "ふいいいいいいいいいいんん",
    "んんん",
    "きん",
    "きゃん",
    "きょん"
  ];
  const K_GROUP = ["きん","きん","きゃん","きょん"];

  function pickNormal(){
    return TOKENS[Math.floor(Math.random()*TOKENS.length)];
  }
  function pickFromGroup(group){
    return group[Math.floor(Math.random()*group.length)];
  }

  function generate(n){
    let out = "";
    let prev = null;
    for(let i=0;i<n;i++){
      let choice;
      if(prev && K_GROUP.includes(prev)){
        if(Math.random() < 0.7){
          choice = pickFromGroup(K_GROUP);
        }else{
          choice = pickNormal();
        }
      }else{
        choice = pickNormal();
      }
      out += choice;
      prev = choice;
    }
    return out;
  }

  async function copy(txt){
    try{
      await navigator.clipboard.writeText(txt);
    }catch(e){
      console.error(e);
    }
  }

  document.getElementById("genBtn").addEventListener("click", async ()=>{
    const n = parseInt(document.getElementById("count").value,10)||8;
    const txt = generate(n);
    document.getElementById("result").textContent = txt;
    await copy(txt);
  });
</script>
</body>
</html>
